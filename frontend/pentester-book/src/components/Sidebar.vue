<template>
    <aside class="sidebar">
      <router-link to="/" class="logo-link">
        <img src="@/assets/logo.png" alt="Project Logo" class="logo" />
      </router-link>
      <h2>Commands</h2>
      <input
        type="text"
        v-model="searchQuery"
        placeholder="Search commands..."
        class="search-input"
      />
      <div class="command-list">
        <router-link
          v-for="command in filteredCommands"
          :key="command.id"
          :to="{ name: 'Command', params: { id: command.id } }"
          class="command-tile"
        >
          <span>{{ command.name }}</span>
        </router-link>
        <p v-if="filteredCommands.length === 0" class="no-results">
          No commands found.
        </p>
      </div>
    </aside>
  </template>
  
  <script>
  import { computed, ref, onMounted } from "vue";
  import { useStore } from "vuex";
  
  export default {
    name: "SidebarMenu",
    setup() {
      const store = useStore();
      const searchQuery = ref("");
  
      const commands = computed(() => store.getters.allCommands);
  
      const filteredCommands = computed(() =>
        commands.value.filter((command) =>
          searchQuery.value
            .toLowerCase()
            .split(" ")
            .every((term) => command.name.toLowerCase().includes(term))
        )
      );
  
      onMounted(async () => {
        if (!store.state.isLoaded) {
          await store.dispatch("fetchCommands");
        }
      });
  
      return {
        searchQuery,
        filteredCommands,
      };
    },
  };
  </script>
  
  <style scoped>
  .sidebar {
    width: 300px;
    padding: 20px 0;
    background-color: #1f1f1f;
    box-shadow: 2px 0 5px rgba(0, 0, 0, 0.5);
    overflow-y: auto;
    color: #e0e0e0;
  }
  
  .logo-link {
    display: block;
    text-align: center;
    margin-bottom: 15px;
  }
  
  .logo {
    max-width: 80%;
    height: auto;
    margin: 0 auto;
  }
  
  .sidebar h2 {
    font-size: 1.5rem;
    margin-bottom: 10px;
    padding-left: 20px;
  }
  
  .search-input {
    width: calc(100% - 60px);
    margin: 0 20px 15px;
    padding: 10px;
    border: none;
    border-radius: 5px;
    background-color: #292929;
    color: #e0e0e0;
    font-size: 1rem;
  }
  
  .search-input::placeholder {
    color: #aaa;
  }
  
  .command-list {
    display: flex;
    flex-direction: column;
  }
  
  .command-tile {
    background-color: #292929;
    border-bottom: 1px solid #383838;
    padding: 15px 20px;
    transition: background-color 0.3s, box-shadow 0.3s;
    text-align: left;
    width: 100%;
    color: inherit;
    text-decoration: none;
  }
  
  .command-tile:last-child {
    border-bottom: none;
  }
  
  .command-tile:hover {
    background-color: #3a3a3a;
    box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.3);
  }
  
  .command-tile:visited {
    color: inherit;
  }
  
  .command-tile span {
    font-weight: bold;
  }
  
  .no-results {
    color: #aaa;
    padding: 15px 20px;
    text-align: center;
  }
  </style>
  